<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>beer-game.message-handler documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">beer-game.server</span> <span class="project-version">master</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>beer-game</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>components</span></div></div></li><li class="depth-3 branch"><a href="beer-game.components.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="beer-game.components.routes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></a></li><li class="depth-3 branch"><a href="beer-game.components.webserver.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>webserver</span></div></a></li><li class="depth-3"><a href="beer-game.components.websocket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>websocket</span></div></a></li><li class="depth-2 branch"><a href="beer-game.config.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handlers</span></div></div></li><li class="depth-3 branch"><a href="beer-game.handlers.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3 branch"><a href="beer-game.handlers.auth-test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth-test</span></div></a></li><li class="depth-3 branch"><a href="beer-game.handlers.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-3 branch"><a href="beer-game.handlers.events-test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events-test</span></div></a></li><li class="depth-3 branch"><a href="beer-game.handlers.game.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>game</span></div></a></li><li class="depth-3"><a href="beer-game.handlers.system.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>system</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>logic</span></div></div></li><li class="depth-3 branch"><a href="beer-game.logic.game.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>game</span></div></a></li><li class="depth-3"><a href="beer-game.logic.game-logic-test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>game-logic-test</span></div></a></li><li class="depth-2 branch current"><a href="beer-game.message-handler.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>message-handler</span></div></a></li><li class="depth-2 branch"><a href="beer-game.message-handler-test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message-handler-test</span></div></a></li><li class="depth-2 branch"><a href="beer-game.messages.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>messages</span></div></a></li><li class="depth-2 branch"><a href="beer-game.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-2 branch"><a href="beer-game.server-utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server-utils</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec</span></div></div></li><li class="depth-3 branch"><a href="beer-game.spec.event.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>event</span></div></a></li><li class="depth-3"><a href="beer-game.spec.game.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>game</span></div></a></li><li class="depth-2 branch"><a href="beer-game.store.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>store</span></div></a></li><li class="depth-2 branch"><a href="beer-game.store-test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store-test</span></div></a></li><li class="depth-2 branch"><a href="beer-game.test-util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test-util</span></div></a></li><li class="depth-2 branch"><a href="beer-game.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><a href="beer-game.util-test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util-test</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -920px;"><span class="top" style="height: 929px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="beer-game.message-handler.html#var-broadcast"><div class="inner"><span>broadcast</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-dispatch-internal"><div class="inner"><span>dispatch-internal</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-event"><div class="inner"><span>event</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-event-handler"><div class="inner"><span>event-handler</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-handle-internally-dispatched"><div class="inner"><span>handle-internally-dispatched</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-message-handler"><div class="inner"><span>message-handler</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-msg-.3Einbox"><div class="inner"><span>msg-&gt;inbox</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-msg-chan"><div class="inner"><span>msg-chan</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-outbox.21"><div class="inner"><span>outbox!</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-receive-internal"><div class="inner"><span>receive-internal</span></div></a></li><li class="depth-1"><a href="beer-game.message-handler.html#var-with-auth"><div class="inner"><span>with-auth</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">beer-game.message-handler</h1><div class="doc"><div class="markdown"><p>Dynamic message handler that dispatches all incoming websocket messages to the respective handlers, and sends the result to the clients that are supposed to receive them. Also serves as an internal message dispatcher using a <code>clojure.core/async</code> csp channel <a href="beer-game.message-handler.html#var-msg-chan">msg-chan</a> for communication between the domain-specific handlers.</p></div></div><div class="public anchor" id="var-broadcast"><h3>broadcast</h3><div class="usage"><code>(broadcast message)</code><code>(broadcast message uids)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-dispatch-internal"><h3>dispatch-internal</h3><div class="usage"><code>(dispatch-internal orig-msg [msg data :as internal-msg])</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-event"><h3>event</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-event-handler"><h3>event-handler</h3><div class="usage"><code>(event-handler msg)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-handle-internally-dispatched"><h3>handle-internally-dispatched</h3><div class="usage"><code>(handle-internally-dispatched msg)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-message-handler"><h3>message-handler</h3><div class="usage"><code>(message-handler {:as websocket-component, :keys [ring-ajax-post ring-ajax-get-or-ws-handshake incoming send! connected-uids]})</code></div><div class="doc"><div class="markdown"><p>Wraps the websocket message handlers in a closure that takes the websocket component.</p></div></div><div class="src-link"><a href="https://git.rz.uni-augsburg.de/pi-m/beer_game/blob/master/src/clj/beer_game/message_handler.clj#L18">view source</a></div></div><div class="public anchor" id="var-msg-.3Einbox"><h3>msg-&gt;inbox</h3><div class="usage"><code>(msg-&gt;inbox ev-msg)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-msg-chan"><h3>msg-chan</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-outbox.21"><h3>outbox!</h3><div class="usage"><code>(outbox! {:keys [uid ?reply-fn], :as ev-msg} internal-msg)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-receive-internal"><h3>receive-internal</h3><div class="usage"><code>(receive-internal)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-with-auth"><h3>with-auth</h3><div class="usage"><code>(with-auth msg send-fn)</code></div><div class="doc"><div class="markdown"></div></div></div></div></body></html>